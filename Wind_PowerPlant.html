<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wind Power Plant - Interactive</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Custom Tailwind Configuration -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    keyframes: {
                        windFlow: {
                            '0%': { transform: 'translateX(-50px)', opacity: '0' },
                            '50%': { opacity: '1' },
                            '100%': { transform: 'translateX(800px)', opacity: '0' }
                        },
                        spinSlow: {
                            '0%': { transform: 'rotate(0deg)' },
                            '100%': { transform: 'rotate(360deg)' }
                        },
                        spinFast: {
                            '0%': { transform: 'rotate(0deg)' },
                            '100%': { transform: 'rotate(360deg)' }
                        },
                        electronFlow: {
                            '0%': { strokeDashoffset: '20' },
                            '100%': { strokeDashoffset: '0' }
                        }
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-slate-50">
    <div id="root"></div>

    <script type="text/babel">
        // --- Imports & Setup ---
        const { useState, useEffect } = React;

        // --- Inline Icons ---
        const IconWrapper = ({ children, size = 20, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                {children}
            </svg>
        );

        const Wind = (p) => <IconWrapper {...p}><path d="M9.59 4.59A2 2 0 1 1 11 8H2m10.59 11.41A2 2 0 1 0 14 16H2m15.73-8.27A2.5 2.5 0 1 1 19.5 12H2"/></IconWrapper>;
        const Zap = (p) => <IconWrapper {...p}><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></IconWrapper>;
        const Fan = (p) => <IconWrapper {...p}><path d="M12 12a4 4 0 1 0-4-4 4 4 0 0 0 4 4zm0 0a4 4 0 1 0 4 4 4 4 0 0 0-4-4zm0 0a4 4 0 1 0-4 4 4 4 0 0 0 4-4zm0 0a4 4 0 1 0 4-4 4 4 0 0 0-4 4z"/><path d="M12 12v.01"/></IconWrapper>;
        const Info = (p) => <IconWrapper {...p}><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></IconWrapper>;
        const Settings = (p) => <IconWrapper {...p}><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></IconWrapper>;
        const HelpCircle = (p) => <IconWrapper {...p}><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><path d="M12 17h.01"/></IconWrapper>;
        const Activity = (p) => <IconWrapper {...p}><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></IconWrapper>;

        // --- Data ---

        const COMPONENTS = [
            {
                id: 'blades',
                name: 'Rotor Blades',
                role: 'Energy Capture',
                description: 'Aerodynamic foils that capture wind kinetic energy. The curved shape creates lift (Bernoulli principle), causing the rotor to spin.',
                type: 'mechanical',
                specs: 'Fiberglass / Composite'
            },
            {
                id: 'hub',
                name: 'Rotor Hub',
                role: 'Blade Attachment',
                description: 'The central point connecting the blades to the main shaft. Contains pitch control mechanisms to adjust blade angle.',
                type: 'mechanical',
                specs: 'Cast Iron / Steel'
            },
            {
                id: 'nacelle',
                name: 'Nacelle Housing',
                role: 'Component Protection',
                description: 'The streamlined housing atop the tower that protects the key drive train components (gearbox, generator, brakes) from weather.',
                type: 'structural',
                specs: 'Weatherproof Shell'
            },
            {
                id: 'gearbox',
                name: 'Gearbox',
                role: 'Speed Increaser',
                description: 'Connects the low-speed shaft (rotor) to the high-speed shaft (generator). Increases rotational speed from ~15 RPM to ~1500 RPM.',
                type: 'mechanical',
                specs: 'Planetary Gears'
            },
            {
                id: 'generator',
                name: 'Generator',
                role: 'Energy Conversion',
                description: 'Converts rotational mechanical energy into electricity via electromagnetic induction. Usually an Induction or Synchronous generator.',
                type: 'electrical',
                specs: 'DFIG / Synchronous'
            },
            {
                id: 'controller',
                name: 'Controller & Anemometer',
                role: 'System Control',
                description: 'Measures wind speed/direction. Yaws the nacelle into the wind, controls blade pitch, and activates brakes in storms.',
                type: 'control',
                specs: 'SCADA Integration'
            },
            {
                id: 'tower',
                name: 'Tower',
                role: 'Structural Support',
                description: 'Raises the rotor into higher, more laminar wind speeds. Contains ladders/lifts and power cables running to the ground.',
                type: 'structural',
                specs: 'Tubular Steel / Concrete'
            },
            {
                id: 'transformer',
                name: 'Step-Up Transformer',
                role: 'Grid Connection',
                description: 'Located at the base. Steps up the low voltage output from the generator (e.g., 690V) to medium voltage (e.g., 33kV) for the grid.',
                type: 'electrical',
                specs: 'Low V â†’ Medium V'
            },
            {
                id: 'grid',
                name: 'Utility Grid',
                role: 'Transmission',
                description: 'The network that distributes the generated wind power to homes and industries.',
                type: 'electrical',
                specs: 'Grid Integration'
            }
        ];

        // --- Main Component ---

        function WindPlantApp() {
            const [activeId, setActiveId] = useState(null);
            const [simulating, setSimulating] = useState(false); // true = rated wind, false = calm
            const [quizMode, setQuizMode] = useState(false);
            const [quizTarget, setQuizTarget] = useState(null);
            const [quizScore, setQuizScore] = useState({ correct: 0, attempts: 0 });

            // Toggle Simulation
            const toggleSim = () => {
                setSimulating(!simulating);
            };

            // Quiz Logic
            const startQuiz = () => {
                setQuizMode(true);
                setSimulating(false);
                setActiveId(null);
                setQuizScore({ correct: 0, attempts: 0 });
                nextQuizQuestion();
            };

            const nextQuizQuestion = () => {
                const randomComp = COMPONENTS[Math.floor(Math.random() * COMPONENTS.length)];
                setQuizTarget(randomComp);
            };

            const handleComponentClick = (id) => {
                if (quizMode) {
                    const isCorrect = id === quizTarget?.id;
                    setQuizScore(prev => ({ 
                        correct: prev.correct + (isCorrect ? 1 : 0), 
                        attempts: prev.attempts + 1 
                    }));
                    if (isCorrect) {
                        setTimeout(nextQuizQuestion, 600);
                    }
                } else {
                    setActiveId(id === activeId ? null : id);
                }
            };

            const getFill = (id, baseColor) => {
                if (simulating) {
                    if (['blades', 'hub', 'gearbox'].includes(id)) return '#fbbf24'; // Mechanical Active
                    if (['generator', 'transformer', 'grid'].includes(id)) return '#60a5fa'; // Electrical Active
                }
                
                if (activeId === id) return '#fbbf24';
                if (quizMode && id === quizTarget?.id && quizScore.attempts > 0) return '#fbbf24';
                return baseColor;
            };

            const activeComponent = COMPONENTS.find(c => c.id === activeId);

            return (
                <div className="w-full min-h-screen bg-slate-50 text-slate-900 font-sans flex flex-col items-center p-4 md:p-8">
                    
                    {/* Header */}
                    <div className="w-full max-w-7xl mb-8 flex flex-col md:flex-row items-start md:items-center justify-between gap-6">
                        <div>
                            <div className="flex items-center gap-3 mb-2">
                                <span className={`text-xs font-bold px-3 py-1 rounded uppercase tracking-wider transition-colors ${simulating ? 'bg-green-100 text-green-800' : 'bg-slate-200 text-slate-600'}`}>
                                    {simulating ? 'Rated Wind Speed (Generating)' : 'Low Wind Speed (Idle)'}
                                </span>
                                <span className="bg-slate-200 text-slate-600 text-xs font-bold px-3 py-1 rounded uppercase tracking-wider">Renewable Energy</span>
                            </div>
                            <h1 className="text-4xl md:text-5xl font-bold text-slate-900 tracking-tight">Wind Power Plant</h1>
                            <p className="text-slate-600 text-lg mt-2">Interactive anatomy of a horizontal-axis wind turbine (HAWT).</p>
                        </div>
                        
                        <div className="flex gap-4">
                            <button onClick={toggleSim} className={`flex items-center gap-2 px-6 py-3 rounded-lg text-base font-bold transition-all shadow-sm ${simulating ? 'bg-red-500 text-white ring-2 ring-red-300' : 'bg-green-600 text-white ring-2 ring-green-300'}`}>
                                <Wind size={20} className={simulating ? "animate-pulse" : ""}/>
                                {simulating ? 'Stop Wind' : 'Start Wind'}
                            </button>
                            <button onClick={quizMode ? () => setQuizMode(false) : startQuiz} className={`flex items-center gap-2 px-6 py-3 rounded-lg text-base font-bold transition-all shadow-sm ${quizMode ? 'bg-purple-600 text-white ring-2 ring-purple-300' : 'bg-white border border-slate-300 text-slate-700 hover:bg-slate-50'}`}>
                                <HelpCircle size={20}/> {quizMode ? 'Exit Quiz' : 'Start Quiz'}
                            </button>
                        </div>
                    </div>

                    {/* Main Layout */}
                    <div className="flex flex-col lg:flex-row gap-8 w-full max-w-7xl h-auto lg:h-[700px]">
                        
                        {/* Diagram Canvas */}
                        <div className="flex-1 bg-sky-50 rounded-xl shadow-md border border-slate-200 relative overflow-hidden group min-h-[500px]">
                            
                            <svg viewBox="0 0 800 600" className="w-full h-full select-none cursor-pointer">
                                <defs>
                                    <linearGradient id="groundGrad" x1="0" y1="0" x2="0" y2="1">
                                        <stop offset="0%" stopColor="#86efac"/>
                                        <stop offset="100%" stopColor="#4ade80"/>
                                    </linearGradient>
                                    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
                                      <feDropShadow dx="2" dy="2" stdDeviation="2" floodOpacity="0.1"/>
                                    </filter>
                                </defs>

                                {/* --- ENVIRONMENT --- */}
                                {/* Clouds */}
                                <g className="opacity-80">
                                    <path d="M100,100 Q120,80 140,100 T180,100" fill="none" stroke="white" strokeWidth="20" strokeLinecap="round" />
                                    <path d="M600,150 Q620,130 640,150 T680,150" fill="none" stroke="white" strokeWidth="20" strokeLinecap="round" />
                                </g>

                                {/* Wind Animation Lines */}
                                {simulating && (
                                    <g opacity="0.4">
                                        <path d="M-50,150 L850,150" stroke="#94a3b8" strokeWidth="2" strokeDasharray="20 40" className="animate-[windFlow_2s_linear_infinite]" />
                                        <path d="M-50,250 L850,250" stroke="#94a3b8" strokeWidth="2" strokeDasharray="30 50" className="animate-[windFlow_2.5s_linear_infinite]" style={{animationDelay: '0.5s'}} />
                                        <path d="M-50,350 L850,350" stroke="#94a3b8" strokeWidth="2" strokeDasharray="25 35" className="animate-[windFlow_1.8s_linear_infinite]" style={{animationDelay: '1s'}} />
                                    </g>
                                )}

                                {/* Ground */}
                                <path d="M0,500 Q400,480 800,500 L800,600 L0,600 Z" fill="url(#groundGrad)" />

                                {/* --- TOWER & FOUNDATION --- */}
                                <g onClick={() => handleComponentClick('tower')} className="hover:opacity-90">
                                    {/* Tower Base */}
                                    <path d="M380,520 L420,520 L410,250 L390,250 Z" fill={getFill('tower', '#e2e8f0')} stroke="#94a3b8" strokeWidth="2" />
                                </g>

                                {/* --- CABLES (Inside Tower) --- */}
                                <line x1="400" y1="250" x2="400" y2="520" stroke={simulating ? "#f59e0b" : "#cbd5e1"} strokeWidth="4" strokeDasharray="4 2" className={simulating ? "animate-[electronFlow_0.5s_linear_infinite]" : ""} />

                                {/* --- TRANSFORMER (Base) --- */}
                                <g onClick={() => handleComponentClick('transformer')} className="hover:opacity-90">
                                    <rect x="425" y="480" width="40" height="40" rx="4" fill={getFill('transformer', '#cbd5e1')} stroke="#64748b" strokeWidth="2" />
                                    <text x="445" y="505" textAnchor="middle" fontSize="10" fontWeight="bold" fill="#475569">TRF</text>
                                    <path d="M420,500 L425,500" stroke="#f59e0b" strokeWidth="2" />
                                    <path d="M465,500 L550,500 L550,550" stroke="#f59e0b" strokeWidth="2" strokeDasharray="4 2" className={simulating ? "animate-[electronFlow_0.5s_linear_infinite]" : ""} />
                                </g>

                                {/* --- GRID --- */}
                                <g onClick={() => handleComponentClick('grid')} className="hover:opacity-90">
                                    <line x1="550" y1="550" x2="700" y2="550" stroke={getFill('grid', '#475569')} strokeWidth="4" />
                                    <circle cx="700" cy="550" r="5" fill="#f59e0b" />
                                    <text x="650" y="575" textAnchor="middle" fontSize="10" fontWeight="bold">GRID</text>
                                </g>

                                {/* --- NACELLE (Cutaway View) --- */}
                                <g transform="translate(300, 180)">
                                    <g onClick={() => handleComponentClick('nacelle')} className="hover:opacity-90">
                                        {/* Main Housing Shape */}
                                        <path d="M0,20 Q10,0 50,0 L180,0 Q200,10 200,35 Q200,60 180,70 L50,70 Q10,70 0,50 Z" fill={getFill('nacelle', '#f1f5f9')} stroke="#94a3b8" strokeWidth="2" />
                                    </g>

                                    {/* --- INTERNAL COMPONENTS --- */}
                                    
                                    {/* Low Speed Shaft (Connected to Rotor) */}
                                    <rect x="-10" y="30" width="60" height="10" fill="#94a3b8" />
                                    
                                    {/* Gearbox */}
                                    <g onClick={(e) => {e.stopPropagation(); handleComponentClick('gearbox');}} className="hover:cursor-pointer">
                                        <rect x="50" y="20" width="40" height="30" rx="2" fill={getFill('gearbox', '#cbd5e1')} stroke="#64748b" strokeWidth="2" />
                                        <circle cx="70" cy="35" r="10" fill="none" stroke="#64748b" strokeWidth="2" strokeDasharray="4 2" className={simulating ? "origin-[70px_35px] animate-[spinSlow_2s_linear_infinite]" : ""} />
                                    </g>

                                    {/* High Speed Shaft */}
                                    <rect x="90" y="32" width="20" height="6" fill="#94a3b8" />

                                    {/* Generator */}
                                    <g onClick={(e) => {e.stopPropagation(); handleComponentClick('generator');}} className="hover:cursor-pointer">
                                        <rect x="110" y="15" width="50" height="40" rx="4" fill={getFill('generator', '#cbd5e1')} stroke="#64748b" strokeWidth="2" />
                                        <path d="M125,15 L125,55 M145,15 L145,55" stroke="#94a3b8" strokeWidth="1" />
                                        {/* Status Light */}
                                        <circle cx="150" cy="25" r="3" fill={simulating ? "#22c55e" : "#ef4444"} />
                                    </g>

                                    {/* Controller/Anemometer (Top Back) */}
                                    <g onClick={(e) => {e.stopPropagation(); handleComponentClick('controller');}} className="hover:cursor-pointer">
                                        <line x1="170" y1="10" x2="170" y2="-15" stroke="#475569" strokeWidth="2" />
                                        <path d="M160,-15 L180,-15" stroke="#475569" strokeWidth="2" />
                                        <circle cx="160" cy="-15" r="3" fill="#ef4444" className={simulating ? "origin-[170px_-15px] animate-spin" : ""}/>
                                        <circle cx="180" cy="-15" r="3" fill="#ef4444" className={simulating ? "origin-[170px_-15px] animate-spin" : ""}/>
                                    </g>

                                    {/* Cables going down */}
                                    <path d="M135,55 L135,100" stroke="#f59e0b" strokeWidth="2" strokeDasharray="2 2" />

                                </g>

                                {/* --- ROTOR & BLADES (Front) --- */}
                                {/* Transform needs to center on the hub location (300, 215) relative to SVG origin */}
                                <g transform="translate(300, 215)">
                                    <g className={simulating ? "animate-[spinSlow_4s_linear_infinite]" : ""}>
                                        
                                        {/* Hub */}
                                        <circle cx="0" cy="0" r="15" fill={getFill('hub', '#e2e8f0')} stroke="#94a3b8" strokeWidth="2" onClick={() => handleComponentClick('hub')} />

                                        {/* Blades - Grouped for rotation */}
                                        <g onClick={() => handleComponentClick('blades')} className="hover:opacity-90 cursor-pointer">
                                            {/* Blade 1 (Up) */}
                                            <path d="M-5,0 Q-15,-60 0,-180 Q15,-60 5,0 Z" fill={getFill('blades', '#f8fafc')} stroke="#cbd5e1" strokeWidth="1" />
                                            {/* Blade 2 (Right Down) */}
                                            <path d="M-5,0 Q-15,-60 0,-180 Q15,-60 5,0 Z" fill={getFill('blades', '#f8fafc')} stroke="#cbd5e1" strokeWidth="1" transform="rotate(120)" />
                                            {/* Blade 3 (Left Down) */}
                                            <path d="M-5,0 Q-15,-60 0,-180 Q15,-60 5,0 Z" fill={getFill('blades', '#f8fafc')} stroke="#cbd5e1" strokeWidth="1" transform="rotate(240)" />
                                        </g>
                                        
                                        {/* Hub Cap */}
                                        <circle cx="0" cy="0" r="8" fill="#cbd5e1" pointerEvents="none"/>
                                    </g>
                                </g>

                                {/* Labels & Quiz Overlay */}
                                {quizMode && quizTarget && (
                                    <g>
                                        <rect x="150" y="40" width="500" height="100" rx="12" fill="white" stroke="#a855f7" strokeWidth="3" filter="url(#shadow)" />
                                        <text x="400" y="80" textAnchor="middle" className="text-lg fill-slate-400 font-bold uppercase tracking-widest">Find Component</text>
                                        <text x="400" y="115" textAnchor="middle" className="text-4xl fill-purple-700 font-black">{quizTarget.name}</text>
                                    </g>
                                )}
                            </svg>

                             {/* Legend Overlay */}
                             <div className="absolute bottom-6 left-6 bg-white/95 p-6 rounded-lg shadow-md border border-slate-200 backdrop-blur-sm pointer-events-none w-72">
                                <div className="text-sm font-bold uppercase text-slate-500 mb-3">System Status</div>
                                {simulating ? (
                                    <div className="flex flex-col gap-3 animate-in fade-in">
                                        <div className="flex items-center gap-2 text-green-600 font-bold text-lg"><Fan size={20} className="animate-spin"/> Generating</div>
                                        <div className="text-sm text-slate-600 leading-relaxed">
                                            Wind spins rotor. Gearbox speeds up shaft. Generator produces electricity sent to Grid.
                                        </div>
                                    </div>
                                ) : (
                                    <div className="flex flex-col gap-3 animate-in fade-in">
                                        <div className="flex items-center gap-2 text-slate-500 font-bold text-lg"><Wind size={20}/> Idle / Calm</div>
                                        <div className="text-sm text-slate-600 leading-relaxed">
                                            Wind speed below cut-in (3-4 m/s). Turbine is idle. No power generation.
                                        </div>
                                    </div>
                                )}
                            </div>

                        </div>

                        {/* Info Panel */}
                        <div className="w-full lg:w-96 flex flex-col gap-6">
                            <div className={`flex-1 bg-white border border-slate-200 p-8 rounded-xl shadow-md transition-all duration-300 ${activeComponent ? 'opacity-100 translate-x-0' : 'opacity-50 translate-x-4'}`}>
                                {activeComponent ? (
                                    <>
                                        <div className="flex items-center justify-between mb-6 border-b border-slate-100 pb-4">
                                            <h2 className="text-2xl font-bold text-slate-800 leading-tight">{activeComponent.name}</h2>
                                            <span className={`text-xs font-bold px-2 py-1 rounded uppercase tracking-wide ${
                                                activeComponent.type === 'electrical' ? 'bg-blue-100 text-blue-700' :
                                                activeComponent.type === 'mechanical' ? 'bg-orange-100 text-orange-700' :
                                                'bg-slate-100 text-slate-700'
                                            }`}>
                                                {activeComponent.type.toUpperCase()}
                                            </span>
                                        </div>
                                        <div className="space-y-8">
                                            <div>
                                                <div className="flex items-center gap-2 text-sm font-bold text-slate-400 uppercase mb-2">
                                                    <Info size={18}/> Function
                                                </div>
                                                <p className="text-base text-slate-700 leading-relaxed">{activeComponent.description}</p>
                                            </div>
                                            <div className="bg-slate-50 p-5 rounded-lg border border-slate-100">
                                                <div className="flex items-center gap-2 mb-2 text-sm font-bold text-slate-800">
                                                    <Settings size={16}/> Engineering Role
                                                </div>
                                                <div className="text-sm text-slate-600 font-medium">{activeComponent.role}</div>
                                                <div className="mt-4 flex items-center gap-2 mb-2 text-sm font-bold text-slate-800">
                                                    <Activity size={16}/> Key Spec
                                                </div>
                                                <div className="text-sm text-slate-600 font-mono bg-white p-2 rounded border border-slate-200 inline-block">
                                                    {activeComponent.specs}
                                                </div>
                                            </div>
                                        </div>
                                    </>
                                ) : (
                                    <div className="h-full flex flex-col items-center justify-center text-center text-slate-300">
                                        <Fan size={64} className="mb-6 text-slate-200 opacity-50"/>
                                        <p className="text-lg font-bold text-slate-400">Select a component<br/>to view specs.</p>
                                    </div>
                                )}
                            </div>
                        </div>

                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<WindPlantApp />);
    </script>
</body>
</html>